

<!DOCTYPE html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="docsearch:name" content="Tripy" />
    <meta name="docsearch:package_type" content="" />
    <meta name="docsearch:release" content="0.0.1" />
    <meta name="docsearch:version" content="0.0.1" />
    
      <title>An Introduction To Tripy &mdash; Tripy 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/bootstrap-icons.css" type="text/css" />
          <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=3d3fbe02" />
          <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
          <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../../_static/pygments_dark.css?v=b20cc3f5" />
          <link rel="stylesheet" type="text/css" href="../../_static/colorsets/sphinx-nefertiti-green.min.css" />
          <link rel="stylesheet" type="text/css" href="../../_static/fonts/nunito/stylesheet.css" />
          <link rel="stylesheet" type="text/css" href="../../_static/fonts/red-hat-mono/stylesheet.css" />
          <link rel="stylesheet" type="text/css" href="../../_static/pygments_dark.css?v=b20cc3f5" />
          <link rel="stylesheet" type="text/css" href="../../_static/style.css?v=270043a8" />
        <link rel="index" title="Index" href="../../genindex.html" />
        <link rel="search" title="Search" href="../../search.html" />
        <link rel="top" title="Tripy 0.0.1 documentation" href="#" />
    <style>
      :root {
        --nftt-body-font-family: "Nunito", var(--nftt-font-sans-serif) !important;
        --nftt-font-monospace: "Red Hat Mono", var(--nftt-font-family-monospace) !important;
        --nftt-project-name-font: var(--nftt-body-font-family);
        --nftt-documentation-font: var(--nftt-body-font-family);
        --nftt-doc-headers-font: "Georgia", var(--nftt-documentation-font);--nftt-documentation-font-size: 1.0rem;--nftt-monospace-font-size: 0.85rem;}
      h1 *, h2 *, h3 *, h4 *, h5 *, h6 * { font-size: inherit; }
    </style>
  </head>
  <body>
    <header class="navbar navbar-expand-lg navbar-dark nftt-navbar flex-column fixed-top">
      <div class="skip-links container-xxl visually-hidden-focusable overflow-hidden justify-content-start">
        <div class="border-bottom mb-2 pb-2 w-100">
          <a class="d-none d-md-inline-flex p-2 m-1" href="#sidebar-filter">Skip to docs navigation</a>
          <a class="d-inline-flex p-2 m-1" href="#content">Skip to main content</a>
        </div>
      </div>
      <nav class="container-xxl nftt-gutter flex-wrap flex-lg-nowrap" aria-label="Main navigation">
        <div class="nftt-navbar-toggler">
          <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebar" aria-controls="sidebar" aria-label="Toggle documentation navigation">
            <i class="bi bi-list"></i>
          </button>
        </div>
          <a href="../../index.html"
              
              class="navbar-brand p-0 me-0 md-lg-2"
          ><span class="brand-text">Tripy</span></a>
        
        <div class="d-flex d-lg-none">
          <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#nfttSearch" aria-controls="nfttSearch" aria-label="Search">
            <i class="bi bi-search"></i>
          </button>
          <button class="navbar-toggler p-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#nfttNavbar" aria-controls="nfttNavbar" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
        </div>
        
<div class="offcanvas-lg offcanvas-end flex-grow-1" tabindex="-1" id="nfttSearch" aria-labelledby="nfttSearchOffcanvasLabel" data-bs-scroll="true">
  <div class="offcanvas-header px-4 pb-0">
    <h5 class="offcanvas-title fw-bold" id="nfttSearchOffcanvasLabel">Search the documentation</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close" data-bs-target="#nfttSearch"></button>
  </div>
  <div class="offcanvas-body p-4 pt-0 p-lg-0 px-lg-3">
    <hr class="d-lg-none text-white-50">
    <ul class="navbar-nav flex-row align-items-center flex-wrap ms-md-auto">
      <li class="nav-item col-12 col-lg-auto">
        <form id="nftt-search-form" action="../../search.html" method="get">
          <div class="input-group">
            <input type="text" name="q" class="form-control" placeholder="Search docs" aria-label="Search" aria-describedby="button-search">
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <button class="btn btn-primary" type="submit" id="button-search" aria-label="Search"><i class="bi bi-search"></i></button>
          </div>
        </form>
      </li>
    </ul>
  </div>
</div>

        <div class="offcanvas-lg offcanvas-end" tabindex="-1" id="nfttNavbar" aria-labelledby="nfttNavbarOffcanvasLabel" data-bs-scroll="true">
          <div class="offcanvas-header px-4 pb-0">
            <div class="offcanvas-title text-white fw-bold" id="nfttNavbarOffcanvasLabel"><span class="brand-text">Nefertiti for Sphinx</span></div>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close" data-bs-target="#nfttNavbar"></button>
          </div>
          <div class="offcanvas-body p-4 pt-0 p-lg-0">
            <hr class="d-lg-none text-white-50">
            <ul class="navbar-nav flex-row align-items-center flex-wrap ms-md-auto">
              
              <li class="nav-item col-12 col-lg-auto">
                <a class="nav-link py-2 py-lg-0 px-0 px-lg-2" href="https://github.com/NVIDIA/TensorRT-Incubator" target="_blank" rel="noopener">
                  <div class="d-flex align-items-center">
                    <div class="me-2">
                      <i class="bi bi-git size-24"></i>
                    </div>
                    <div class="repo d-flex flex-column align-items-center" data-snftt-repo-url="https://github.com/NVIDIA/TensorRT-Incubator">
                      Tripy
                      <div class="d-flex justify-content-center" data-snftt-repo-metrics>
                        <span class="pe-2 d-flex justify-content-center align-items-center">
                          <i class="bi bi-tag size-14"></i>
                          <span class="repo-metric" data-snftt-repo-tag></span>
                        </span>
                        <span class="pe-2 d-flex justify-content-center align-items-center">
                          <i class="bi bi-star size-14"></i>
                          <span class="repo-metric" data-snftt-repo-stars></span>
                        </span>
                        <span class="d-flex justify-content-center align-items-center">
                          <i class="bi bi-diagram-2 size-14"></i>
                          <span class="repo-metric" data-snftt-repo-forks></span>
                        </span>
                      </div>
                    </div>
                  </div>
                </a>
              </li>
              <li class="nav-item col-12 col-lg-auto h-100" aria-hidden="true">
                <div class="vr d-none d-lg-flex h-100 mx-lg-2 text-white"></div>
                <hr class="d-lg-none text-white-50">
              </li>
              
              <!-- version_dropdown.html -->

              
              <!-- colorscheme_dropdown.html -->
<li class="nav-item dropdown">
  <a class="nav-link d-flex py-2 px-0 px-lg-2 dropdown-toggle align-items-center" id="snftt-luz" href="#" data-bs-toggle="dropdown" data-bs-display="static" aria-expanded="false" aria-label="Toggle light/dark">
    <i class="bi bi-circle-half" data-snftt-luz-icon-active></i>
    <span id="snftt-luz-text" class="d-lg-none small ms-2">Toggle light/dark</span>
  </a>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="snftt-luz-text">
    <li>
      <h6 class="dropdown-header">Light/dark</h6>
    </li>
    <li>
      <a class="dropdown-item d-flex align-items-center" data-snftt-luz="light" href="#" aria-pressed="false">
        <span class="small">
          <i class="bi bi-sun" data-snftt-luz-icon="light"></i>
        </span>
        <span class="small ms-3">Light</span>
        <i class="bi bi-check ms-auto"></i>
      </a>
    </li>
    <li>
      <a class="dropdown-item d-flex align-items-center" data-snftt-luz="dark" href="#" aria-pressed="false">
        <span class="small">
          <i class="bi bi-moon-stars" data-snftt-luz-icon="dark"></i>
        </span>
        <span class="small ms-3">Dark</span>
        <i class="bi bi-check ms-auto"></i>
      </a>
    </li>
    <li>
      <a class="dropdown-item current d-flex align-items-center" data-snftt-luz="default" href="#" aria-pressed="false">
        <span class="small">
          <i class="bi bi-circle-half" data-snftt-luz-icon="default"></i>
        </span>
        <span class="small ms-3">Default</span>
        <i class="bi bi-check ms-auto"></i>
      </a>
    </li>
  </ul>
</li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <div class="container-xxl nftt-gutter nftt-layout">
      <aside class="nftt-sidebar">
        <div class="title d-none d-md-block">
          <i class="bi bi-book"></i>&nbsp;&nbsp;<span>Table of contents</span>
        </div>
        <div id="sidebar" tabindex="-1" class="offcanvas-lg offcanvas-start" aria-labelledby="nfttSidebarOffcanvasLabel">
            <!-- danirus sidebartemplate: "globaltoc.html" --><div class="offcanvas-header border-bottom">
  <h5 class="offcanvas-title" id="nfttSidebarOffcanvasLabel">
    Table of contents
  </h5>
  <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close" data-bs-target="#sidebar"></button>
</div>

<div class="offcanvas-body">
  <nav class="toc" aria-label="Main menu">
    <div class="mb-3 p-1 pt-3 pb-4 border-bottom">
      <input id="sidebar-filter" type="text" name="filter" class="form-control form-control-sm" placeholder="filter" aria-label="filter">
    </div>
    <p class="caption" role="heading"><span class="caption-text">User Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../pre0_user_guides/introduction-to-tripy.html">An Introduction To Tripy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pre0_user_guides/quantization.html">Quantization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../compiler/index.html">Compiler</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../compiler/arg_info.html">ArgInfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../compiler/executable.html">Executable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../compiler/input_info.html">InputInfo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../config.html">config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datatype.html">dtype</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../device.html">device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../exception/index.html">Exception</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../exception/tripy_exception.html">TripyException</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../logger.html">logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/index.html">Module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../modules/conv.html">Conv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modules/conv_transpose.html">ConvTranspose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modules/embedding.html">Embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modules/group_norm.html">GroupNorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modules/layer_norm.html">LayerNorm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modules/linear.html">Linear</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../modules/parameter.html">Parameter</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../shape.html">Shape</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tensor/index.html">Tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tensor_operations/index.html">Tensor Operations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/abs.html">abs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/all.html">all</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/allclose.html">allclose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/any.html">any</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/arange.html">arange</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/argmax.html">argmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/argmin.html">argmin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/cast.html">cast</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/concatenate.html">concatenate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/copy.html">copy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/cos.html">cos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/dequantize.html">dequantize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/exp.html">exp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/expand.html">expand</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/flip.html">flip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/full.html">full</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/full_like.html">full_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/gather.html">gather</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/gelu.html">gelu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/iota.html">iota</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/iota_like.html">iota_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/log.html">log</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/masked_fill.html">masked_fill</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/max.html">max</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/maximum.html">maximum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/mean.html">mean</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/minimum.html">minimum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/ones.html">ones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/ones_like.html">ones_like</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/permute.html">permute</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/plugin.html">plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/prod.html">prod</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/quantize.html">quantize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/relu.html">relu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/reshape.html">reshape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/rsqrt.html">rsqrt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/sigmoid.html">sigmoid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/silu.html">silu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/sin.html">sin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/softmax.html">softmax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/split.html">split</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/sqrt.html">sqrt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/squeeze.html">squeeze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/sum.html">sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/tanh.html">tanh</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/transpose.html">transpose</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/tril.html">tril</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/triu.html">triu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/unsqueeze.html">unsqueeze</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/var.html">var</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/where.html">where</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/zeros.html">zeros</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tensor_operations/zeros_like.html">zeros_like</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../post0_developer_guides/architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../post0_developer_guides/debugging.html">Debugging MLIR-TensorRT backend</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../post0_developer_guides/design-decisions.html">Design Decisions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../post0_developer_guides/how-to-add-new-ops.html">Adding New Operators</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../post0_developer_guides/mlir-dialect-python-apis.html">Using Python APIs of MLIR Dialects</a></li>
</ul>

  </nav>
  <template data-toggle-item-template>
    <button class="btn btn-sm btn-link toctree-expand" type="button">
      <i class="bi bi-caret-right"></i>
      <span class="visually-hidden">Toggle menu contents</span>
    </button>
  </template>
</div>
        </div>
      </aside>
      <main class="nftt-main">
        <article id="content" class="nftt-content" role="main">
    <section id="an-introduction-to-tripy">
<h1><a class="toc-backref" href="#id1" role="doc-backlink">An Introduction To Tripy</a><a class="headerlink" href="#an-introduction-to-tripy" title="Link to this heading">¶</a></h1>
<nav class="contents" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#an-introduction-to-tripy" id="id1">An Introduction To Tripy</a></p>
<ul>
<li><p><a class="reference internal" href="#what-is-tripy" id="id2">What Is Tripy?</a></p></li>
<li><p><a class="reference internal" href="#your-first-tripy-program" id="id3">Your First Tripy Program</a></p>
<ul>
<li><p><a class="reference internal" href="#lazy-evaluation-putting-off-work" id="id4">Lazy Evaluation: Putting Off Work</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#organizing-code-using-modules" id="id5">Organizing Code Using Modules</a></p></li>
<li><p><a class="reference internal" href="#to-compile-or-not-to-compile" id="id6">To <code class="docutils literal notranslate"><span class="pre">compile</span></code> Or Not To <code class="docutils literal notranslate"><span class="pre">compile</span></code></a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="what-is-tripy">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">What Is Tripy?</a><a class="headerlink" href="#what-is-tripy" title="Link to this heading">¶</a></h2>
<p>Tripy is a compiler that compiles deep learning models for inference using TensorRT as a backend.
It aims to be fast, easy to debug, and provide an easy-to-use Pythonic interface.</p>
</section>
<section id="your-first-tripy-program">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Your First Tripy Program</a><a class="headerlink" href="#your-first-tripy-program" title="Link to this heading">¶</a></h2>
<p>But enough talk; let’s see some code:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">a</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="linenos">2</span><span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mf">1.5</span>
<span class="linenos">3</span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="linenos">4</span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="n">cp</span><span class="o">.</span><span class="n">from_dlpack</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1.5</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.5000</span><span class="p">,</span> <span class="mf">2.5000</span><span class="p">,</span> <span class="mf">3.5000</span><span class="p">,</span> <span class="mf">4.5000</span><span class="p">,</span> <span class="mf">5.5000</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">gpu</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,))</span>
</pre></div>
</div>
<p>This should look familiar if you’ve used linear algebra or deep learning libraries like
NumPy and PyTorch.</p>
<section id="lazy-evaluation-putting-off-work">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Lazy Evaluation: Putting Off Work</a><a class="headerlink" href="#lazy-evaluation-putting-off-work" title="Link to this heading">¶</a></h3>
<p>One important point is that Tripy uses a lazy evaluation model; that is,
no computation is performed until a value is actually needed.</p>
<p>In the example above, that means that <code class="docutils literal notranslate"><span class="pre">c</span></code> will not be evaluated until it is used,
such as when we print its values.</p>
<p>In most cases, this is simply an implementation detail that you will not notice.
One exception to this is when attempting to time code. Consider the following code:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="kn">import</span> <span class="nn">time</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="linenos">4</span><span class="n">a</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="linenos">5</span><span class="n">b</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="linenos">6</span><span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">tp</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="linenos">7</span><span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="linenos">8</span>
<span class="linenos">9</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time to create &#39;c&#39;: </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Time</span> <span class="n">to</span> <span class="n">create</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">0.079</span> <span class="n">seconds</span><span class="o">.</span>
</pre></div>
</div>
<p>It looks like Tripy is very fast! While Tripy <em>execution</em> is very fast, compiling the program
takes some time. The reason the time is so low relative to what we’d expect for initializing
and running the compiler is that <em>we’re not doing that yet</em>.</p>
<p>The actual compilation and computation only happens when we evaluate <code class="docutils literal notranslate"><span class="pre">c</span></code>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="linenos">2</span><span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="linenos">3</span><span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Time to print &#39;c&#39;: </span><span class="si">{</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> seconds.&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.0000</span><span class="p">,</span> <span class="mf">2.7616</span><span class="p">,</span> <span class="mf">4.9640</span><span class="p">,</span> <span class="mf">6.9951</span><span class="p">,</span> <span class="mf">8.9993</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">gpu</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,))</span>
<span class="n">Time</span> <span class="n">to</span> <span class="nb">print</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mf">0.267</span> <span class="n">seconds</span><span class="o">.</span>
</pre></div>
</div>
<p>That is why the time to print <code class="docutils literal notranslate"><span class="pre">c</span></code> is so much higher than the time to create it.</p>
<p>If we wanted to time individual parts of the model, we would insert calls to <code class="docutils literal notranslate"><span class="pre">.eval()</span></code>;
for example, adding a <code class="docutils literal notranslate"><span class="pre">c.eval()</span></code> prior to checking the end time would tell us how
long it took to compile and run the subgraph that computes <code class="docutils literal notranslate"><span class="pre">c</span></code>.</p>
</section>
</section>
<section id="organizing-code-using-modules">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Organizing Code Using Modules</a><a class="headerlink" href="#organizing-code-using-modules" title="Link to this heading">¶</a></h2>
<p>The <a class="reference internal" href="../../modules/index.html#tripy.Module" title="tripy.Module"><code class="xref py py-class docutils literal notranslate"><span class="pre">tripy.Module</span></code></a> API allows you to create reusable blocks that can be composed together
to create models. Modules may be comprised of other modules, including modules predefined
by Tripy, like <a class="reference internal" href="../../modules/linear.html#tripy.Linear" title="tripy.Linear"><code class="xref py py-class docutils literal notranslate"><span class="pre">tripy.Linear</span></code></a> and <a class="reference internal" href="../../modules/layer_norm.html#tripy.LayerNorm" title="tripy.LayerNorm"><code class="xref py py-class docutils literal notranslate"><span class="pre">tripy.LayerNorm</span></code></a>.</p>
<p>For example, we can define a Transfomer MLP block like so:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">class</span> <span class="nc">MLP</span><span class="p">(</span><span class="n">tp</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="linenos"> 2</span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embedding_size</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tp</span><span class="o">.</span><span class="n">float32</span><span class="p">):</span>
<span class="linenos"> 3</span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="linenos"> 4</span>        <span class="bp">self</span><span class="o">.</span><span class="n">c_fc</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">embedding_size</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">embedding_size</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="linenos"> 5</span>        <span class="bp">self</span><span class="o">.</span><span class="n">c_proj</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">embedding_size</span><span class="p">,</span> <span class="n">embedding_size</span><span class="p">,</span> <span class="n">bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span>    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="linenos"> 8</span>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_fc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="linenos"> 9</span>        <span class="n">x</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">gelu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="linenos">10</span>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_proj</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="linenos">11</span>        <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
<p>To use it, we just need to construct and call it:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">mlp</span> <span class="o">=</span> <span class="n">MLP</span><span class="p">(</span><span class="n">embedding_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="n">inp</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">iota</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tp</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="linenos">4</span><span class="n">out</span> <span class="o">=</span> <span class="n">mlp</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mlp</span><span class="o">.</span><span class="n">state_dict</span><span class="p">()</span>
<span class="go">{</span>
<span class="go">    c_fc.weight: tensor(</span>
<span class="go">        [[0.0000, 1.0000],</span>
<span class="go">         [2.0000, 3.0000],</span>
<span class="go">         [4.0000, 5.0000],</span>
<span class="go">         [6.0000, 7.0000],</span>
<span class="go">         [8.0000, 9.0000],</span>
<span class="go">         [10.0000, 11.0000],</span>
<span class="go">         [12.0000, 13.0000],</span>
<span class="go">         [14.0000, 15.0000]], </span>
<span class="go">        dtype=float32, loc=gpu:0, shape=(8, 2)),</span>
<span class="go">    c_fc.bias: tensor([0.0000, 1.0000, 2.0000, 3.0000, 4.0000, 5.0000, 6.0000, 7.0000], dtype=float32, loc=gpu:0, shape=(8,)),</span>
<span class="go">    c_proj.weight: tensor(</span>
<span class="go">        [[0.0000, 1.0000, 2.0000, 3.0000, 4.0000, 5.0000, 6.0000, 7.0000],</span>
<span class="go">         [8.0000, 9.0000, 10.0000, 11.0000, 12.0000, 13.0000, 14.0000, 15.0000]], </span>
<span class="go">        dtype=float32, loc=gpu:0, shape=(2, 8)),</span>
<span class="go">    c_proj.bias: tensor([0.0000, 1.0000], dtype=float32, loc=gpu:0, shape=(2,)),</span>
<span class="go">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inp</span>
<span class="go">tensor(</span>
<span class="go">    [[0.0000, 1.0000]], </span>
<span class="go">    dtype=float32, loc=gpu:0, shape=(1, 2))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">out</span>
<span class="go">tensor(</span>
<span class="go">    [[447.9999, 1183.7289]], </span>
<span class="go">    dtype=float32, loc=gpu:0, shape=(1, 2))</span>
</pre></div>
</div>
</section>
<section id="to-compile-or-not-to-compile">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">To <code class="docutils literal notranslate"><span class="pre">compile</span></code> Or Not To <code class="docutils literal notranslate"><span class="pre">compile</span></code></a><a class="headerlink" href="#to-compile-or-not-to-compile" title="Link to this heading">¶</a></h2>
<p>All the code we’ve seen so far has been using Tripy’s eager mode. It is also possible to compile
functions or modules ahead of time, which can result in significantly better performance.</p>
<p><em>Note that the compiler imposes some requirements on the functions/modules it can compile.</em>
<em>See <a class="reference internal" href="../../compiler/index.html#tripy.Compiler" title="tripy.Compiler"><code class="xref py py-class docutils literal notranslate"><span class="pre">tripy.Compiler</span></code></a> for details.</em></p>
<p>Let’s compile the MLP module we defined above as an example:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">compiler</span> <span class="o">=</span> <span class="n">tp</span><span class="o">.</span><span class="n">Compiler</span><span class="p">(</span><span class="n">mlp</span><span class="p">)</span>
<span class="linenos">2</span>
<span class="linenos">3</span><span class="c1"># When we compile, we need to indicate which parameters to the function should be runtime inputs.</span>
<span class="linenos">4</span><span class="c1"># In this case, MLP takes a single input tensor for which we can specify our desired shape and datatype.</span>
<span class="linenos">5</span><span class="n">fast_mlp</span> <span class="o">=</span> <span class="n">compiler</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">tp</span><span class="o">.</span><span class="n">InputInfo</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tp</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
</pre></div>
</div>
<p>It is also possible to compile for a range of possible input shapes.
See <a class="reference internal" href="../../compiler/index.html#tripy.Compiler.compile" title="tripy.Compiler.compile"><code class="xref py py-func docutils literal notranslate"><span class="pre">tripy.Compiler.compile()</span></code></a> for details.</p>
<p>Now let’s benchmark the compiled version against eager mode:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="n">ITERS</span> <span class="o">=</span> <span class="mi">10</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="linenos"> 4</span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ITERS</span><span class="p">):</span>
<span class="linenos"> 5</span>    <span class="n">out</span> <span class="o">=</span> <span class="n">mlp</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
<span class="linenos"> 6</span>    <span class="n">out</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span> <span class="c1"># Recall that we need to evaluate in order to actually materialize `out`</span>
<span class="linenos"> 7</span><span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="n">eager_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="n">ITERS</span>
<span class="linenos">10</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Eager mode average time: </span><span class="si">{</span><span class="n">eager_time</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="linenos">13</span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ITERS</span><span class="p">):</span>
<span class="linenos">14</span>    <span class="n">out</span> <span class="o">=</span> <span class="n">fast_mlp</span><span class="p">(</span><span class="n">inp</span><span class="p">)</span>
<span class="linenos">15</span>    <span class="n">out</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="linenos">16</span><span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="n">compiled_time</span> <span class="o">=</span> <span class="p">(</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">/</span> <span class="n">ITERS</span>
<span class="linenos">19</span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Compiled mode average time: </span><span class="si">{</span><span class="p">(</span><span class="n">end</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">ITERS</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Eager</span> <span class="n">mode</span> <span class="n">average</span> <span class="n">time</span><span class="p">:</span> <span class="mf">4.9878</span> <span class="n">seconds</span>
<span class="n">Compiled</span> <span class="n">mode</span> <span class="n">average</span> <span class="n">time</span><span class="p">:</span> <span class="mf">0.0030</span> <span class="n">seconds</span>
</pre></div>
</div>
<p>As you can see, the compiled module is significantly faster than running the module
in eager mode.</p>
</section>
</section>

</article>
        
          <aside class="nftt-toc">
            <div class="mt-3 mb-1 my-lg-0 ps-xl-3 text-muted">
              <button class="btn btn-link link-dark p-md-0 mb-2 mb-md-0 text-decoration-none nftt-toc-toggle d-md-none" type="button" data-bs-toggle="collapse" data-bs-target="#tocContents" aria-expanded="false" aria-controls="tocContents"
              >On this page <i class="ms-2 bi bi-chevron-expand"></i></button>
              <div class="title d-none d-md-block">
                <i class="bi bi-file-earmark-text"></i>&nbsp;&nbsp;<span class="small">On this page</span>
              </div>
              <hr class="d-none d-md-block my-2">
              <div class="collapse nftt-toc-collapse" id="tocContents">
                <nav id="TableOfContents">
                  <ul>
<li><a class="reference internal" href="#">An Introduction To Tripy</a><ul>
<li><a class="reference internal" href="#what-is-tripy">What Is Tripy?</a></li>
<li><a class="reference internal" href="#your-first-tripy-program">Your First Tripy Program</a><ul>
<li><a class="reference internal" href="#lazy-evaluation-putting-off-work">Lazy Evaluation: Putting Off Work</a></li>
</ul>
</li>
<li><a class="reference internal" href="#organizing-code-using-modules">Organizing Code Using Modules</a></li>
<li><a class="reference internal" href="#to-compile-or-not-to-compile">To <code class="docutils literal notranslate"><span class="pre">compile</span></code> Or Not To <code class="docutils literal notranslate"><span class="pre">compile</span></code></a></li>
</ul>
</li>
</ul>

                </nav>
              </div>
            </div>
          </aside>
        
      </main>
    </div>

    <footer class="nftt-footer">
      
<nav id="paginator"></nav>

      <div class="py-5 px-4 px-md-3">
  <div class="container">
    

    <div class="row">
      <div class="col-lg-12 text-center">
        <a class="brand-text d-inline-flex align-items-center mb-2 text-decoration-none" href="/" aria-label="Nefertiti-for-Sphinx">
          <span class="fs-6 fw-bold">Tripy</span>
        </a>
        
          <ul class="list-unstyled small text-muted">
            <li>2024, NVIDIA</li>
          </ul>
        
        
      </div>
    </div>
  </div>
</div>
    </footer>
    <script src="../../_static/documentation_options.js?v=d45e8c67"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>

    <script type="text/javascript" src="../../_static/bootstrap.bundle.min.js"></script>
    <script type="text/javascript" src="../../_static/sphinx-nefertiti.min.js"></script>
    
  </body>
</html>